<Page
    x:Class="Video_Clip2.DrawPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:xaml="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:draggers="using:Video_Clip2.Clips.Draggers"
    xmlns:controls1="using:Video_Clip2.Controls"
    xmlns:elements="using:Video_Clip2.Elements"
    xmlns:times="using:Video_Clip2.Elements.Times"
    xmlns:elementsTransitions="using:Video_Clip2.Elements.Transitions"
    xmlns:menus="using:Video_Clip2.Menus"
    xmlns:toolsElements="using:Video_Clip2.Tools.Elements"
    Background="Black" 
    mc:Ignorable="d"
    >


    <Page.Resources>
        <!--Double-->
        <x:Double x:Key="AppBarHeight">48</x:Double>
        
        <x:Double x:Key="TrackLeftWidth">72</x:Double>
        <Thickness x:Key="TrackLeftMargin">72,0,72,0</Thickness>
        <x:Double x:Key="TrackLeftLeft">-72</x:Double>

        <x:Double x:Key="TrackLeft2Width">180</x:Double>
        <Thickness x:Key="TrackLeft2Margin">252,0,252,0</Thickness>

        <x:Double x:Key="TimelineHeight">30</x:Double>
        <x:Double x:Key="TimelineTop">-30</x:Double>
        <Thickness x:Key="TimelineMargin">0,30,0,0</Thickness>
        
        <!--StaticResource-->
        <SolidColorBrush x:Key="ListViewItemBackgroundSelected" Color="{ThemeResource SystemAccentColor}"/>
        <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPointerOver" Color="{ThemeResource SystemAccentColor}"/>
        <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPressed" Color="{ThemeResource SystemAccentColor}"/>
        <SolidColorBrush x:Key="ListViewItemForegroundSelected" Color="White"/>
        <SolidColorBrush x:Key="ListViewItemForegroundSelectedPointerOver" Color="White"/>
        <SolidColorBrush x:Key="ListViewItemForegroundSelectedPressed" Color="White"/>

        <!--Storyboard-->
        <Storyboard x:Name="Storyboard">
            <DoubleAnimation x:Name="Animation" From="{x:Null}" To="{x:Null}" Duration="0:0:0.6" 
                             Storyboard.TargetProperty="Height" Storyboard.TargetName="PreviewGrid" 
                             EnableDependentAnimation="True">
                <DoubleAnimation.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <!--Style-->
        <Style TargetType="ScrollViewer">
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="HorizontalScrollMode" Value="Enabled"/>
            <Setter Property="IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="VerticalScrollMode" Value="Disabled"/>
            <Setter Property="IsVerticalRailEnabled" Value="True"/>
            <Setter Property="ZoomMode" Value="Disabled"/>
            <Setter Property="IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="BringIntoViewOnFocusChange" Value="True"/>
        </Style>
        <Style x:Key="MenuFlyoutItemStyle" TargetType="MenuFlyoutItem">
            <Setter Property="MinWidth" Value="200"/>
            <Setter Property="Height" Value="44"/>
        </Style>
        <Style x:Key="AppToolTipStyle" TargetType="ToolTip">
            <Setter Property="BorderBrush" Value="{ThemeResource AppBlueLinearGradientBrush}"/>
            <Setter Property="Background" Value="{ThemeResource AppBlueLinearGradientBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <!--Flyout-->
        <MenuFlyout x:Name="EditFlyout" Placement="Left">
            <MenuFlyout.MenuFlyoutPresenterStyle>
                <Style TargetType="MenuFlyoutPresenter">
                    <Setter Property="Padding" Value="0"/>
                </Style>
            </MenuFlyout.MenuFlyoutPresenterStyle>
        </MenuFlyout>
        <Flyout x:Name="SpeedFlyout" Placement="top">
            <elements:TimeSlider x:Name="SpeedSlider" Value="1" Minimum="0.25" Maximum="4" StepFrequency="0.25" TickPlacement="Outside" TickFrequency="0.25" Foreground="{ThemeResource AppBlueLinearGradientBrush}">
                <Slider.Header>
                    Speed
                </Slider.Header>
            </elements:TimeSlider>
        </Flyout>
        <Flyout x:Name="StretchFlyout" Placement="Top">
            <Flyout.FlyoutPresenterStyle>
                <Style TargetType="FlyoutPresenter">
                    <Setter Property="Padding" Value="0,4"/>
                </Style>
            </Flyout.FlyoutPresenterStyle>
            <toolsElements:StretchListView x:Name="StretchListView"/>
        </Flyout>
        <Flyout x:Name="VolumeFlyout" Placement="top">
            <elements:TimeSlider x:Name="VolumeSlider" Value="100" TickPlacement="Outside" TickFrequency="25" Foreground="{ThemeResource AppBlueLinearGradientBrush}">
                <Slider.Header>
                    Volume
                </Slider.Header>
            </elements:TimeSlider>
        </Flyout>
        <Flyout x:Name="TransformFlyout" Placement="top">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="FlipHorizontalButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <PathIcon>
                        <PathIcon.Data>
                            M18.477,20L7.843,29.724L7.843,10.276L18.477,20ZM21.523,20L32.157,29.724L32.157,10.276L21.523,20ZM23.207,20.063L31.057,27.241L31.057,12.885L23.207,20.063Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
                <Button x:Name="FlipVerticalButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <PathIcon>
                        <PathIcon.Data>
                            M20,21.523L10.276,32.157L29.724,32.157L20,21.523ZM20,18.477L10.276,7.843L29.724,7.843L20,18.477ZM19.937,16.793L12.759,8.943L27.115,8.943L19.937,16.793Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
                <Button x:Name="RotateLeftButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <PathIcon>
                        <PathIcon.Data>
                            M13.949,12.731C13.968,12.561 14.047,12.402 14.172,12.283L18.038,8.6C18.332,8.321 18.796,8.332 19.075,8.625C19.354,8.918 19.343,9.383 19.05,9.662L16.536,12.057C17.694,12.043 19.123,12.029 20,12.029C25.558,12.029 30.07,16.541 30.07,22.099C30.07,27.656 25.558,32.168 20,32.168C14.442,32.168 9.93,27.656 9.93,22.099C9.93,22.08 9.931,22.061 9.933,22.042L9.936,20.729C9.935,20.324 10.264,19.996 10.668,19.995C11.073,19.995 11.402,20.323 11.402,20.728C11.402,20.728 11.404,21.846 11.399,22.074C11.398,22.092 11.398,22.109 11.397,22.124C11.411,26.86 15.26,30.701 20,30.701C24.748,30.701 28.603,26.847 28.603,22.099C28.603,17.35 24.748,13.496 20,13.496C19.11,13.496 17.651,13.51 16.486,13.524L19.05,15.966C19.343,16.245 19.354,16.71 19.075,17.003C18.796,17.296 18.332,17.307 18.038,17.028L14.172,13.345C14.123,13.299 14.081,13.246 14.047,13.189L14.044,13.184C13.981,13.075 13.944,12.949 13.944,12.814C13.944,12.786 13.946,12.758 13.949,12.731Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
                <Button x:Name="RotateRightButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <PathIcon>
                        <PathIcon.Data>
                            M26.051,12.731C26.032,12.561 25.953,12.402 25.828,12.283L21.962,8.6C21.668,8.321 21.204,8.332 20.925,8.625C20.646,8.918 20.657,9.383 20.95,9.662L23.464,12.057C22.306,12.043 20.877,12.029 20,12.029C14.442,12.029 9.93,16.541 9.93,22.099C9.93,27.656 14.442,32.168 20,32.168C25.558,32.168 30.07,27.656 30.07,22.099C30.07,22.08 30.069,22.061 30.067,22.042L30.064,20.729C30.065,20.324 29.736,19.996 29.332,19.995C28.927,19.995 28.598,20.323 28.598,20.728C28.598,20.728 28.596,21.846 28.601,22.074C28.602,22.092 28.602,22.109 28.603,22.124C28.589,26.86 24.74,30.701 20,30.701C15.252,30.701 11.397,26.847 11.397,22.099C11.397,17.35 15.252,13.496 20,13.496C20.89,13.496 22.349,13.51 23.514,13.524L20.95,15.966C20.657,16.245 20.646,16.71 20.925,17.003C21.204,17.296 21.668,17.307 21.962,17.028L25.828,13.345C25.877,13.299 25.919,13.246 25.953,13.189L25.956,13.184C26.019,13.075 26.056,12.949 26.056,12.814C26.056,12.786 26.054,12.758 26.051,12.731Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
            </StackPanel>
        </Flyout>
        <Flyout x:Name="OpacityFlyout" Placement="top">
            <elements:TimeSlider x:Name="OpacitySlider" Value="100" TickPlacement="Outside" TickFrequency="25" Foreground="{ThemeResource AppBlueLinearGradientBrush}">
                <Slider.Header>
                    Opacity
                </Slider.Header>
            </elements:TimeSlider>
        </Flyout>
    </Page.Resources>


    <Grid>

        <!--VisualState-->
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>

                <!--Phone-->
                <VisualState x:Name="Phone">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="AppBarLeftScrollViewer.Width" Value="150"/>

                        <Setter Target="PreviewGrid.(Grid.RowSpan)" Value="2"/>
                        <Setter Target="AppBarBorder.Visibility" Value="Collapsed"/>
                        <Setter Target="AppBarBorder2.Visibility" Value="Visible"/>

                        <Setter Target="AppBarLeftBorder.(Grid.Row)" Value="3"/>
                        <Setter Target="AppBarRightBorder.(Grid.Row)" Value="3"/>

                        <Setter Target="AppBarLeftBorder2.Margin" Value="0"/>
                        <Setter Target="AppBarLeftBorder2.RequestedTheme" Value="Dark"/>
                        <Setter Target="AppBarLeftBorder2.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarRightBorder2.Visibility" Value="Collapsed"/>

                        <Setter Target="AppBarLeftScrollViewer.Margin" Value="0"/>
                        <Setter Target="AppBarLeftScrollViewer.HorizontalAlignment" Value="Right"/>
                        <Setter Target="AppBarLeftScrollViewer.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarRightScrollViewer.(Grid.Row)" Value="3"/>
                        <Setter Target="AppBarRightScrollViewer.Margin" Value="{StaticResource TrackLeftMargin}"/>
                        <Setter Target="AppBarRightScrollViewer.HorizontalAlignment" Value="Center"/>
                        <Setter Target="AppBarRightScrollViewer.Background" Value="{x:Null}"/>

                        <Setter Target="PlayGrid.VerticalAlignment" Value="Bottom"/>
                    </VisualState.Setters>
                </VisualState>

                <!--Pad-->
                <VisualState x:Name="Pad">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="600" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="PreviewGrid.(Grid.RowSpan)" Value="2"/>
                        <Setter Target="AppBarBorder.Visibility" Value="Collapsed"/>
                        <Setter Target="AppBarBorder2.Visibility" Value="Visible"/>

                        <Setter Target="AppBarLeftBorder.(Grid.Row)" Value="3"/>
                        <Setter Target="AppBarRightBorder.(Grid.Row)" Value="3"/>

                        <Setter Target="AppBarLeftBorder2.Margin" Value="0"/>
                        <Setter Target="AppBarLeftBorder2.RequestedTheme" Value="Dark"/>
                        <Setter Target="AppBarLeftBorder2.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarRightBorder2.Visibility" Value="Collapsed"/>

                        <Setter Target="AppBarLeftScrollViewer.Margin" Value="0"/>
                        <Setter Target="AppBarLeftScrollViewer.HorizontalAlignment" Value="Right"/>
                        <Setter Target="AppBarLeftScrollViewer.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarRightScrollViewer.(Grid.Row)" Value="3"/>
                        <Setter Target="AppBarRightScrollViewer.Margin" Value="{StaticResource TrackLeftMargin}"/>
                        <Setter Target="AppBarRightScrollViewer.HorizontalAlignment" Value="Center"/>
                        <Setter Target="AppBarRightScrollViewer.Background" Value="{x:Null}"/>

                        <Setter Target="PlayGrid.VerticalAlignment" Value="Bottom"/>
                    </VisualState.Setters>
                </VisualState>

                <!--PC-->
                <VisualState x:Name="PC">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="900" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="AppBarLeftBorder2.(Grid.Row)" Value="0"/>
                        <Setter Target="AppBarLeftBorder2.Margin" Value="0"/>
                        <Setter Target="AppBarLeftBorder2.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarLeftBorder2.RequestedTheme" Value="Dark"/>
                        <Setter Target="AppBarRightBorder2.(Grid.Row)" Value="0"/>
                        <Setter Target="AppBarRightBorder2.Margin" Value="0"/>
                        <Setter Target="AppBarRightBorder2.VerticalAlignment" Value="Bottom"/>
                        <Setter Target="AppBarRightBorder2.RequestedTheme" Value="Dark"/>

                        <Setter Target="AppBarLeftScrollViewer.Margin" Value="{StaticResource TrackLeftMargin}"/>
                        <Setter Target="AppBarRightScrollViewer.Margin" Value="{StaticResource TrackLeftMargin}"/>
                    </VisualState.Setters>
                </VisualState>

                <!--Hub-->
                <VisualState x:Name="Hub">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1100" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                    </VisualState.Setters>
                </VisualState>

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>


        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!--Extension-->
        <elements:ApplicationTitleBarExtension x:Name="ApplicationView" TitleBarColor="Black"/>

        <!--Preview-->
        <controls1:PreviewCanvas x:Name="PreviewGrid"
                   Height="276" MinHeight="100" MaxHeight="700"
                   Scale2="{x:Bind ViewModel.Scale, Mode=TwoWay}" Size2="{x:Bind ViewModel.Size, Mode=OneWay}">
            <xaml:CanvasControl x:Name="PreviewCanvas" Width="1920" Height="1080" ClearColor="Black">
                <UIElement.RenderTransformOrigin>
                    0, 0
                </UIElement.RenderTransformOrigin>
                <UIElement.RenderTransform>
                    <CompositeTransform ScaleX="1" ScaleY="1" TranslateX="0" TranslateY="0"/>
                </UIElement.RenderTransform>
            </xaml:CanvasControl>
        </controls1:PreviewCanvas>

        <!--Home-->
        <Button Margin="12"
                HorizontalAlignment="Left" VerticalAlignment="Top"
                Background="{ThemeResource AppBackgroundLight}"
                IsEnabled="{x:Bind IntToBooleanConverter(GroupIndex), Mode=OneWay}">
            <StackPanel Orientation="Horizontal">
                <SymbolIcon Symbol="Home" Width="32"/>
                <TextBlock Margin="4,0">
                    Home
                </TextBlock>
            </StackPanel>
        </Button>
        <!--Export-->
        <Button x:Name="ExportButton" Margin="12"
                    HorizontalAlignment="Right" VerticalAlignment="Top"
                    Background="{ThemeResource AppBlueLinearGradientBrush}" 
                    IsEnabled="{x:Bind IntToBooleanConverter(GroupIndex), Mode=OneWay}"
                    Style="{StaticResource AccentButtonStyle}">
            <StackPanel Orientation="Horizontal">
                <SymbolIcon Symbol="NewWindow" Width="32"/>
                <TextBlock Margin="4,0">
                    Export
                </TextBlock>
            </StackPanel>
        </Button>

        <!--Track-->
        <ScrollViewer x:Name="TrackScrollViewer" Grid.Row="2" Background="{ThemeResource AppBackground}">
            <Border x:Name="TrackCanvas" Background="Transparent"
                        ManipulationMode="{x:Bind ToolTypeComboBox.Tool.TrackManipulationMode, Mode=OneWay}"
                        ManipulationStarted="{x:Bind ToolTypeComboBox.Tool.TrackManipulationStarted, Mode=OneWay}"
                        ManipulationDelta="{x:Bind ToolTypeComboBox.Tool.TrackManipulationDelta, Mode=OneWay}"
                        ManipulationCompleted="{x:Bind ToolTypeComboBox.Tool.TrackManipulationCompleted, Mode=OneWay}"
                        >
                <Canvas Margin="{StaticResource TimelineMargin}" HorizontalAlignment="Left"
                        Width="{x:Bind PositionCanvas.Width, Mode=OneWay}">


                    <StackPanel 
                        Canvas.Left="{StaticResource TrackLeftLeft}" Canvas.Top="{StaticResource TimelineTop}"
                        Width="{StaticResource TrackLeftWidth}" >
                        <!--Track-->
                        <ComboBox x:Name="TrackComboBox"
                             SelectedIndex="2" 
                             Width="{StaticResource TrackLeftWidth}" Height="{StaticResource TimelineHeight}"
                             BorderThickness="0" BorderBrush="{ThemeResource AppBorderBrush}" Background="Transparent">
                            <UIElement.ManipulationMode>
                                None
                            </UIElement.ManipulationMode>
                            <ToolTipService.ToolTip>
                                <ToolTip Style="{StaticResource AppToolTipStyle}">
                                    Track Height
                                </ToolTip>
                            </ToolTipService.ToolTip>
                            <x:Int32>30</x:Int32>
                            <x:Int32>40</x:Int32>
                            <x:Int32>50</x:Int32>
                            <x:Int32>60</x:Int32>
                            <x:Int32>70</x:Int32>
                        </ComboBox>
                        <!--Mute-->
                        <ToggleButton 
                             IsChecked="{x:Bind ViewModel.IsMuted, Mode=TwoWay}"
                             Width="{StaticResource TrackLeftWidth}" Height="{StaticResource AppBarHeight}" 
                             Foreground="{ThemeResource AppBlueLinearGradientBrush}" Background="{ThemeResource AppBackgroundColorMediumLight}" Style="{StaticResource TextBlockButtonStyle}">
                            <UIElement.ManipulationMode>
                                None
                            </UIElement.ManipulationMode>
                            <ToolTipService.ToolTip>
                                <ToolTip Style="{StaticResource AppToolTipStyle}">
                                    Mute
                                </ToolTip>
                            </ToolTipService.ToolTip>
                            <SymbolIcon Symbol="{x:Bind BooleanToMuteConverter(ViewModel.IsMuted), Mode=OneWay}"/>
                        </ToggleButton>
                        <!--Freedom-->
                        <ToggleButton 
                             IsChecked="{x:Bind IsDirectFreedom, Mode=TwoWay}"
                             Width="{StaticResource TrackLeftWidth}" Height="{StaticResource AppBarHeight}" 
                             Foreground="{ThemeResource AppBlueLinearGradientBrush}" Background="{ThemeResource AppBackgroundColorMediumLight}" Style="{StaticResource TextBlockButtonStyle}">
                            <UIElement.ManipulationMode>
                                None
                            </UIElement.ManipulationMode>
                            <ToolTipService.ToolTip>
                                <ToolTip Style="{StaticResource AppToolTipStyle}">
                                    Freedom
                                </ToolTip>
                            </ToolTipService.ToolTip>
                            <SymbolIcon Symbol="{x:Bind BooleanToFreedomConverter(IsDirectFreedom), Mode=OneWay}"/>
                        </ToggleButton>
                    </StackPanel>


                    <!--Position-->
                    <controls1:PositionCanvas x:Name="PositionCanvas"
                        Canvas.Left="0" Canvas.Top="{StaticResource TimelineTop}"
                        IsHitTestVisible="{x:Bind IsDirectFreedom, Mode=OneWay}"
                        Duration="{x:Bind ViewModel.Duration, Mode=OneWay}"
                        TrackScale="{x:Bind ViewModel.TrackScale, Mode=OneWay}"
                        Width="{x:Bind PositionCanvas.Width, Mode=OneWay}" Height="{StaticResource TimelineHeight}"
                        Background="Transparent">
                        <UIElement.ManipulationMode>
                            System,
                            TranslateX
                        </UIElement.ManipulationMode>
                    </controls1:PositionCanvas>
                    <controls1:PinCanvas x:Name="PinCanvas"
                        Canvas.Left="0" Canvas.Top="{StaticResource TimelineTop}"
                        ItemSource="{x:Bind ViewModel.PinCollection, Mode=OneWay}"
                        Position="{x:Bind ViewModel.Position, Mode=OneWay}"
                        TrackScale="{x:Bind ViewModel.TrackScale, Mode=OneWay}"
                        Width="{x:Bind PositionCanvas.Width, Mode=OneWay}" Height="{StaticResource TimelineHeight}">
                        <controls1:PinCanvas.ItemStyle>
                            <Style TargetType="Button">
                                <Setter Property="Width" Value="18"/>
                                <Setter Property="Height" Value="32"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Polygon 
                                                StrokeThickness="2"
                                                Fill="{ThemeResource AppRedLinearGradientBrush}">

                                                <Polygon.Stroke>
                                                    <SolidColorBrush x:Name="SolidColorBrush" Color="Transparent"/>
                                                </Polygon.Stroke>

                                                <!--VisualState-->
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">

                                                        <VisualState x:Name="Normal"/>

                                                        <VisualState x:Name="PointerOver">
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetName="SolidColorBrush" Storyboard.TargetProperty="Color"
                                                                                Duration="00:00:00.2" To="White">
                                                                </ColorAnimation>
                                                            </Storyboard>
                                                        </VisualState>

                                                        <VisualState x:Name="Pressed">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SolidColorBrush" Storyboard.TargetProperty="Color">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="White" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>

                                                        <VisualState x:Name="Disabled">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SolidColorBrush" Storyboard.TargetProperty="Color">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="White" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>

                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>

                                                <Polygon.Points>
                                                    9, 2
                                                    0, 14
                                                    9, 26
                                                    18, 14
                                                </Polygon.Points>
                                            </Polygon>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </controls1:PinCanvas.ItemStyle>
                    </controls1:PinCanvas>
                    <Border x:Name="PinHeader" CornerRadius="0,0,4,4"
                       IsHitTestVisible="False" 
                       Canvas.Left="-6" Canvas.Top="{StaticResource TimelineTop}"
                       Width="12" Height="{StaticResource TimelineHeight}"
                       Visibility="{x:Bind BooleanToVisibilityConverter(IsDirectFreedom), Mode=OneWay}"
                       BorderThickness="2" BorderBrush="{ThemeResource AppRedAbsoluteLinearGradientBrush}"/>


                    <!--Rectangle-->
                    <controls1:RectangleCanvas x:Name="RectangleCanvas"
                        MaximumRows="6" IsHitTestVisible="False"
                        ItemWidth="{x:Bind PositionCanvas.Width, Mode=OneWay}"
                        ItemHeight="{x:Bind ViewModel.TrackHeight, Mode=OneWay}">
                        <controls1:RectangleCanvas.LightStyle>
                            <Style TargetType="Rectangle">
                                <Setter Property="StrokeThickness" Value="1"/>
                                <Setter Property="Stroke" Value="{ThemeResource AppStroke}"/>
                                <Setter Property="Fill" Value="{ThemeResource AppBackgroundMediumLight}"/>
                            </Style>
                        </controls1:RectangleCanvas.LightStyle>
                        <controls1:RectangleCanvas.DarkStyle>
                            <Style TargetType="Rectangle">
                                <Setter Property="StrokeThickness" Value="1"/>
                                <Setter Property="Stroke" Value="{ThemeResource AppStroke}"/>
                                <Setter Property="Fill" Value="{ThemeResource AppBackgroundMediumDark}"/>
                            </Style>
                        </controls1:RectangleCanvas.DarkStyle>
                    </controls1:RectangleCanvas>
                    <!--Items-->
                    <controls1:ItemCanvas x:Name="ItemCanvas"
                        Width="{x:Bind PositionCanvas.Width, Mode=OneWay}"
                        ItemSource="{x:Bind ViewModel.ObservableCollection, Mode=OneWay}"
                        ItemClick="{x:Bind ToolTypeComboBox.Tool.ItemClick, Mode=OneWay}"
                        ItemManipulationStarted="{x:Bind ToolTypeComboBox.Tool.ItemManipulationStarted, Mode=OneWay}"
                        ItemManipulationDelta="{x:Bind ToolTypeComboBox.Tool.ItemManipulationDelta, Mode=OneWay}"
                        ItemManipulationCompleted="{x:Bind ToolTypeComboBox.Tool.ItemManipulationCompleted, Mode=OneWay}"
                         />


                    <!--Dragger-->
                    <draggers:ThumbDragger x:Name="ThumbDragger" Visibility="Collapsed" 
                                           SelectionMode="{x:Bind ViewModel.SelectionMode, Mode=OneWay}" 
                                           Trimmer="{x:Bind ViewModel.Trimmer, Mode=OneWay}" 
                                           TrackHeight="{x:Bind ViewModel.TrackHeight, Mode=OneWay}"
                                           ManipulationStarted="{x:Bind ToolTypeComboBox.Tool.ThumbDraggerManipulationStarted, Mode=OneWay}"
                                           ManipulationDelta="{x:Bind ToolTypeComboBox.Tool.ThumbDraggerManipulationDelta, Mode=OneWay}"
                                           ManipulationCompleted="{x:Bind ToolTypeComboBox.Tool.ThumbDraggerManipulationCompleted, Mode=OneWay}"
                                           >
                        <UIElement.ManipulationMode>
                            System,
                            TranslateX,
                            TranslateY
                        </UIElement.ManipulationMode>
                    </draggers:ThumbDragger>
                    <draggers:LeftDragger x:Name="LeftDragger" Visibility="Collapsed" 
                                          SelectionMode="{x:Bind ViewModel.SelectionMode, Mode=OneWay}" 
                                          Trimmer="{x:Bind ViewModel.Trimmer, Mode=OneWay}" 
                                          TrackHeight="{x:Bind ViewModel.TrackHeight, Mode=OneWay}" 
                                          ManipulationStarted="{x:Bind ToolTypeComboBox.Tool.LeftDraggerManipulationStarted, Mode=OneWay}"
                                          ManipulationDelta="{x:Bind ToolTypeComboBox.Tool.LeftDraggerManipulationDelta, Mode=OneWay}"
                                          ManipulationCompleted="{x:Bind ToolTypeComboBox.Tool.LeftDraggerManipulationCompleted, Mode=OneWay}"
                                          Height="{x:Bind ViewModel.TrackHeight, Mode=OneWay}"
                                          >
                        <UIElement.ManipulationMode>
                            System,
                            TranslateX
                        </UIElement.ManipulationMode>
                    </draggers:LeftDragger>
                    <draggers:RightDragger x:Name="RightDragger" Visibility="Collapsed" 
                                           SelectionMode="{x:Bind ViewModel.SelectionMode, Mode=OneWay}" 
                                           Trimmer="{x:Bind ViewModel.Trimmer, Mode=OneWay}" 
                                           TrackHeight="{x:Bind ViewModel.TrackHeight, Mode=OneWay}" 
                                           ManipulationStarted="{x:Bind ToolTypeComboBox.Tool.RightDraggerManipulationStarted, Mode=OneWay}"
                                           ManipulationDelta="{x:Bind ToolTypeComboBox.Tool.RightDraggerManipulationDelta, Mode=OneWay}"
                                           ManipulationCompleted="{x:Bind ToolTypeComboBox.Tool.RightDraggerManipulationCompleted, Mode=OneWay}"
                                           Height="{x:Bind ViewModel.TrackHeight, Mode=OneWay}"
                                           >
                        <UIElement.ManipulationMode>
                            System,
                            TranslateX
                        </UIElement.ManipulationMode>
                    </draggers:RightDragger>


                    <!--Timeline-->
                    <Line x:Name="Timeline" IsHitTestVisible="False" 
                              Visibility="{x:Bind BooleanToVisibilityConverter(IsDirectFreedom), Mode=OneWay}"
                              X1="0" Y1="0" 
                              X2="0" Y2="512" 
                              StrokeThickness="2" Stroke="{ThemeResource AppRedAbsoluteLinearGradientBrush}"/>

                </Canvas>
            </Border>
        </ScrollViewer>

        <!--Timeline-->
        <Line Grid.Row="2" IsHitTestVisible="False" 
                HorizontalAlignment="Center" VerticalAlignment="Top"
                Visibility="{x:Bind ReverseBooleanToVisibilityConverter(IsDirectFreedom), Mode=OneWay}"
                X1="0" Y1="{StaticResource TimelineHeight}" 
                X2="0" Y2="512" 
                StrokeThickness="2" Stroke="{ThemeResource AppBlueAbsoluteLinearGradientBrush}" />

        <!--Button-->
        <ListView x:Name="ButtonListView" Grid.Row="2" SelectionMode="None" Width="{StaticResource TrackLeftWidth}" HorizontalAlignment="Right" >
            <ListView.Resources>
                <Style TargetType="Button" BasedOn="{StaticResource TextBlockButtonStyle}">
                    <Setter Property="Foreground" Value="{ThemeResource AppBlueLinearGradientBrush}"/>
                    <Setter Property="HorizontalAlignment" Value="Stretch"/>
                    <Setter Property="VerticalAlignment" Value="Stretch"/>
                </Style>
            </ListView.Resources>
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Width" Value="{StaticResource AppBarHeight}"/>
                    <Setter Property="Height" Value="{StaticResource AppBarHeight}"/>
                    <Setter Property="MinWidth" Value="32"/>
                    <Setter Property="MinHeight" Value="32"/>
                    <Setter Property="Padding" Value="2"/>
                    <Setter Property="BorderThickness" Value="2"/>
                    <Setter Property="BorderBrush" Value="{ThemeResource ApplicationForegroundThemeBrush}"/>
                    <Setter Property="Background" Value="{ThemeResource ApplicationPageBackgroundThemeBrush}"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListViewItem">
                                <Border CornerRadius="3" Margin="{TemplateBinding Padding}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}">
                                    <ContentPresenter x:Name="ListViewItemContentPresenter"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.Header>
                <Border Width="{StaticResource TrackLeftWidth}" Height="{StaticResource TimelineHeight}"/>
            </ListView.Header>
            <!--Add-->
            <Button>
                <ToolTipService.ToolTip>
                    <ToolTip Placement="Left">
                        Add
                    </ToolTip>
                </ToolTipService.ToolTip>
                <Button.Flyout>
                    <MenuFlyout Placement="Left">
                        <MenuFlyout.MenuFlyoutPresenterStyle>
                            <Style TargetType="MenuFlyoutPresenter">
                                <Setter Property="Padding" Value="0"/>
                            </Style>
                        </MenuFlyout.MenuFlyoutPresenterStyle>
                        <MenuFlyoutItem x:Name="AddVideoItem" BorderThickness="3,0,0,0" BorderBrush="BlueViolet" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Video"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Video
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="AddAudioItem" BorderThickness="3,0,0,0" BorderBrush="Fuchsia" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Audio"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Audio
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="AddImageItem" BorderThickness="3,0,0,0" BorderBrush="DodgerBlue" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Pictures"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Image
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="AddColorItem" BorderThickness="3,0,0,0" BorderBrush="DarkGray" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Flag"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Color
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="AddTextItem" BorderThickness="3,0,0,0" BorderBrush="Orange" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="FontSize"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Text
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="AddSubtitleItem" BorderThickness="3,0,0,0" BorderBrush="OrangeRed" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="FontColor"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Add From Subtitle
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </Button.Flyout>
                <SymbolIcon Symbol="Add"/>
            </Button>
            <!--Edit-->
            <Button x:Name="EditButton">
                <ToolTipService.ToolTip>
                    <ToolTip Placement="Left">
                        Edit
                    </ToolTip>
                </ToolTipService.ToolTip>
                <Button.Flyout>
                    <MenuFlyout Placement="Left">
                        <MenuFlyout.MenuFlyoutPresenterStyle>
                            <Style TargetType="MenuFlyoutPresenter">
                                <Setter Property="Padding" Value="0"/>
                            </Style>
                        </MenuFlyout.MenuFlyoutPresenterStyle>
                        <MenuFlyoutItem x:Name="EditCutItem" IsEnabled="False" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Cut" Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Cut
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="EditCopyItem" IsEnabled="False" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Copy" Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Copy
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="EditPasteItem" IsEnabled="False" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Paste" Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Paste
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="EditClearItem" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Delete" Foreground="{ThemeResource AppRedLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Clear
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem IsEnabled="False" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="SelectAll" Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                SelectAll
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem IsEnabled="False" Style="{StaticResource MenuFlyoutItemStyle}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="ClearSelection" Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.Text>
                                Deselect
                            </MenuFlyoutItem.Text>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </Button.Flyout>
                <SymbolIcon Symbol="Preview"/>
            </Button>
            <!--Transition-->
            <Button x:Name="TransitionButton">
                <ToolTipService.ToolTip>
                    <ToolTip Placement="Left">
                        Transition
                    </ToolTip>
                </ToolTipService.ToolTip>
                <PathIcon>
                    <PathIcon.Data>
                        M20.019,13.154C20.019,13.341 19.94,13.519 19.802,13.646L17.837,15.44L17.726,15.509L17.605,15.555L17.485,15.577L17.362,15.576L17.246,15.553L17.212,15.543C17.159,15.524 17.108,15.499 17.06,15.467L16.971,15.396L10.01,8.788L3.024,15.418L2.959,15.467C2.911,15.499 2.86,15.524 2.807,15.543L2.687,15.572L2.569,15.579L2.443,15.563L2.322,15.523L2.208,15.459L2.14,15.404L0.217,13.646C0.079,13.519 -0,13.341 0,13.154L0,2.425C0,2.238 0.079,2.059 0.217,1.933L2.182,0.139L2.293,0.069L2.414,0.023L2.534,0.002L2.657,0.003L2.773,0.025L2.807,0.036C2.86,0.054 2.911,0.079 2.959,0.111L3.048,0.183L10.01,6.79L16.995,0.161L17.06,0.111C17.108,0.079 17.159,0.054 17.212,0.036L17.332,0.007L17.45,0L17.576,0.016L17.697,0.056L17.811,0.119L17.88,0.174L19.802,1.933C19.94,2.059 20.019,2.238 20.019,2.425L20.019,13.154ZM1.333,2.861L1.333,12.718C1.333,12.718 2.596,13.977 2.596,13.977L8.97,7.789L2.596,1.602L1.333,2.861ZM11.049,7.789L17.423,13.977L18.686,12.718L18.686,2.861C18.686,2.861 17.423,1.602 17.423,1.602L11.049,7.789Z
                    </PathIcon.Data>
                </PathIcon>
            </Button>
        </ListView>

        <!--Menu-->
        <Grid Grid.Row="2">
            <!--Export-->
            <elementsTransitions:IndexTransitionPanel Index="1" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <menus:SettingMenu/>
            </elementsTransitions:IndexTransitionPanel>
            <!--Property-->
            <elementsTransitions:IndexTransitionPanel Index="2" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <Border Background="{ThemeResource SystemControlAcrylicElementBrush}">
                </Border>
            </elementsTransitions:IndexTransitionPanel>
            <!--Transition-->
            <elementsTransitions:IndexTransitionPanel Index="3" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <menus:TransitionMenu/>
            </elementsTransitions:IndexTransitionPanel>
            <!--Easing-->
            <elementsTransitions:IndexTransitionPanel Index="4" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <menus:EasingMenu/>
            </elementsTransitions:IndexTransitionPanel>
            <!--Effect-->
            <elementsTransitions:IndexTransitionPanel Index="5" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <menus:EffectMenu/>
            </elementsTransitions:IndexTransitionPanel>
            <!--Duration-->
            <elementsTransitions:IndexTransitionPanel Index="6" GroupIndex="{x:Bind GroupIndex, Mode=OneWay}">
                <menus:DurationMenu x:Name="DurationMenu"/>
            </elementsTransitions:IndexTransitionPanel>
        </Grid>

        <!--AppBar-->
        <Border x:Name="AppBarBorder" Grid.Row="1" Visibility="Visible" 
                Height="{StaticResource AppBarHeight}" 
                BorderThickness="0,0,0,1" BorderBrush="{ThemeResource AppStroke}" Background="{ThemeResource AppBackgroundLight}" />
        <Border x:Name="AppBarBorder2" Grid.Row="3" Visibility="Collapsed" 
                Height="{StaticResource AppBarHeight}" 
                BorderThickness="0,1,0,0" BorderBrush="{ThemeResource AppStroke}" Background="{ThemeResource AppBackgroundDark}" />

        <Grid x:Name="AppBarLeftBorder" Grid.Row="1" 
                HorizontalAlignment="Left"
                Width="{StaticResource TrackLeftWidth}" Height="{StaticResource AppBarHeight}"
                Background="{ThemeResource AppBackgroundMediumDark}" >
            <toolsElements:ToolTypeComboBox x:Name="ToolTypeComboBox" 
                        Visibility="{x:Bind IntToVisibilityConverter(GroupIndex), Mode=OneWay}"
                        ToolType="{x:Bind ViewModel.ToolType, Mode=TwoWay}"/>
            <Button x:Name="BackButton" HorizontalAlignment="Stretch"
                Visibility="{x:Bind ReverseIntToVisibilityConverter(GroupIndex), Mode=OneWay}"
                Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                <ToolTipService.ToolTip>
                    <ToolTip Style="{StaticResource AppToolTipStyle}">
                        Back
                    </ToolTip>
                </ToolTipService.ToolTip>
                <SymbolIcon Symbol="Back"/>
            </Button>
        </Grid>
        <Border x:Name="AppBarRightBorder" Grid.Row="1" 
                HorizontalAlignment="Right"
                Width="{StaticResource TrackLeftWidth}" Height="{StaticResource AppBarHeight}"
                Background="{ThemeResource AppBackgroundMediumDark}" >
            <Button x:Name="SpliterButton" HorizontalAlignment="Stretch"
                    Foreground="{ThemeResource AppBlueLinearGradientBrush}" 
                    ManipulationStarted="{x:Bind PreviewGrid.SpliterManipulationStarted,Mode=OneWay}"
                    ManipulationDelta="{x:Bind PreviewGrid.SpliterManipulationDelta,Mode=OneWay}"
                    ManipulationCompleted="{x:Bind PreviewGrid.SpliterManipulationCompleted,Mode=OneWay}"
                    Style="{StaticResource TextBlockButtonStyle}">
                <UIElement.ManipulationMode>
                    TranslateY
                </UIElement.ManipulationMode>
                <SymbolIcon Symbol="GlobalNavigationButton"/>
            </Button>
        </Border>

        <Border x:Name="AppBarLeftBorder2" Grid.Row="1" 
                Margin="{StaticResource TrackLeftMargin}" HorizontalAlignment="Left" 
                Width="{StaticResource TrackLeft2Width}" Height="{StaticResource AppBarHeight}" >
            <times:TimeButton x:Name="TimeButton" Padding="2,0" 
                        Visibility="{x:Bind IntToVisibilityConverter(GroupIndex), Mode=OneWay}"
                        Time="{x:Bind ViewModel.Duration , Mode=TwoWay}" 
                        Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                <TextBlock Margin="4,0" FontWeight="Bold" VerticalAlignment="Center">
                <Run FontSize="24" Foreground="{ThemeResource AppBarItemForegroundThemeBrush}" Text="{x:Bind TimeSpanToStringConverter(ViewModel.Position), Mode=OneWay}"/><Run>/</Run><Run Text="{x:Bind TimeSpanToStringConverter(ViewModel.Duration), Mode=OneWay}"/>
                </TextBlock>
            </times:TimeButton>
        </Border>
        <Border x:Name="AppBarRightBorder2" Grid.Row="1"
                Margin="{StaticResource TrackLeftMargin}" HorizontalAlignment="Right" 
                Width="{StaticResource TrackLeft2Width}" Height="{StaticResource AppBarHeight}" >
            <elements:TimeSlider x:Name="ScaleSlider" Padding="12,0" VerticalAlignment="Center" 
                       Value="{x:Bind ViewModel.TrackScale, Mode=TwoWay}" Minimum="2" Maximum="64" 
                       Foreground="{ThemeResource AppBlueLinearGradientBrush}"/>
        </Border>

        <ScrollViewer x:Name="AppBarLeftScrollViewer" Grid.Row="1" 
                      Margin="{StaticResource TrackLeft2Margin}" HorizontalAlignment="Left"
                      HorizontalScrollBarVisibility="Hidden" >
            <StackPanel Orientation="Horizontal" Visibility="{x:Bind IntToVisibilityConverter(GroupIndex), Mode=OneWay}">
                <!--Undo-->
                <Button x:Name="UndoButton" IsEnabled="False" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Undo
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Undo"/>
                </Button>
                <!--Redo-->
                <Button x:Name="RedoButton" IsEnabled="False" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Redo
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Redo"/>
                </Button>
                <!--FullScreen-->
                <Button x:Name="FullScreenButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Full Screen
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="{x:Bind BooleanToFullScreenConverter(PreviewGrid.IsFullScreen), Mode=OneWay}"/>
                </Button>
                <!--Help-->
                <Button x:Name="HelpButton" IsEnabled="False" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Help
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Help"/>
                </Button>
                <!--Pin-->
                <Button x:Name="PinButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Pin
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="{x:Bind BooleanToPinConverter(PinCanvas.IsPositionOnPin), Mode=OneWay}"/>
                </Button>
            </StackPanel>
        </ScrollViewer>
        <ScrollViewer x:Name="AppBarRightScrollViewer" Grid.Row="1" 
                      Margin="{StaticResource TrackLeft2Margin}" HorizontalAlignment="Right"
                      HorizontalScrollBarVisibility="Hidden" 
                      BorderThickness="0,0,0,1" BorderBrush="{ThemeResource AppBlueLinearGradientBrush}" Background="{ThemeResource AppBackgroundColorDark}" >
            <StackPanel Orientation="Horizontal" >
                <!--Trim-->
                <Button x:Name="TrimButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Trim
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <PathIcon>
                        <PathIcon.Data>
                            M14.523,0.381L5.135,20.208C4.978,20.541 5.12,20.938 5.453,21.096C5.785,21.253 6.183,21.111 6.34,20.779L15.728,0.952C15.886,0.619 15.744,0.222 15.411,0.064C15.079,-0.093 14.681,0.049 14.523,0.381ZM0,16.722C0,17.09 0.298,17.388 0.667,17.388L4.16,17.388C4.421,17.388 4.657,17.237 4.766,17.001L10.43,4.717C10.526,4.511 10.509,4.27 10.387,4.079C10.264,3.887 10.052,3.772 9.825,3.772L0.667,3.772C0.298,3.772 -0,4.07 0,4.438L0,16.722ZM20.864,4.438C20.864,4.07 20.565,3.772 20.197,3.772L16.703,3.772C16.443,3.772 16.207,3.923 16.098,4.159L10.433,16.443C10.338,16.649 10.355,16.89 10.477,17.081C10.6,17.273 10.811,17.388 11.039,17.388L20.197,17.388C20.565,17.388 20.864,17.09 20.864,16.722L20.864,4.438ZM1.333,16.055L1.333,5.105C1.333,5.105 8.784,5.105 8.784,5.105C8.784,5.105 3.734,16.055 3.734,16.055L1.333,16.055ZM19.53,5.105L19.53,16.055C19.53,16.055 12.08,16.055 12.08,16.055C12.08,16.055 17.13,5.105 17.13,5.105L19.53,5.105Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
                <!--Duration-->
                <Button x:Name="DurationButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Duration
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Trim"/>
                </Button>
                <!--Speed-->
                <Button x:Name="SpeedButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Speed
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Rotate"/>
                </Button>
                <!--Stretch-->
                <Button x:Name="StretchButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Stretch
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Switch"/>
                </Button>
                <!--Property-->
                <Button x:Name="PropertyButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Property
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Important"/>
                </Button>
                <!--Easing-->
                <Button x:Name="EasingButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Easing
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Attach"/>
                </Button>
                <!--Effect-->
                <Button x:Name="EffectButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Effect
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="OutlineStar"/>
                </Button>
                <!--Volume-->
                <Button x:Name="VolumeButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Volume
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Volume"/>
                </Button>
                <!--Transform-->
                <Button x:Name="TransformButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Transform
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <PathIcon>
                        <PathIcon.Data>
                            M6.965,18.263L10.648,22.13C10.786,22.275 10.978,22.357 11.179,22.357C11.379,22.357 11.571,22.275 11.71,22.13L15.393,18.263C15.672,17.97 15.661,17.505 15.368,17.226C15.074,16.947 14.61,16.958 14.331,17.252L11.179,20.561C11.179,20.561 8.027,17.252 8.027,17.252C7.747,16.958 7.283,16.947 6.99,17.226C6.697,17.505 6.685,17.97 6.965,18.263ZM18.263,15.393L22.13,11.71C22.275,11.571 22.357,11.379 22.357,11.179C22.357,10.978 22.275,10.786 22.13,10.648L18.263,6.965C17.97,6.685 17.505,6.697 17.226,6.99C16.947,7.283 16.958,7.747 17.252,8.027L20.561,11.179C20.561,11.179 17.252,14.331 17.252,14.331C16.958,14.61 16.947,15.074 17.226,15.368C17.505,15.661 17.97,15.672 18.263,15.393ZM5.106,14.331L1.797,11.179C1.797,11.179 5.106,8.027 5.106,8.027C5.399,7.747 5.41,7.283 5.131,6.99C4.852,6.697 4.387,6.685 4.094,6.965L0.228,10.648C0.082,10.786 -0,10.978 0,11.179C0,11.379 0.082,11.571 0.228,11.71L4.094,15.393C4.387,15.672 4.852,15.661 5.131,15.368C5.41,15.074 5.399,14.61 5.106,14.331ZM8.027,5.106L11.179,1.797C11.179,1.797 14.331,5.106 14.331,5.106C14.61,5.399 15.074,5.41 15.368,5.131C15.661,4.852 15.672,4.387 15.393,4.094L11.71,0.228C11.571,0.082 11.379,0 11.179,0C10.978,-0 10.786,0.082 10.648,0.228L6.965,4.094C6.685,4.387 6.697,4.852 6.99,5.131C7.283,5.41 7.747,5.399 8.027,5.106Z
                        </PathIcon.Data>
                    </PathIcon>
                </Button>
                <!--Opacity-->
                <Button x:Name="OpacityButton" Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Opacity
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <SymbolIcon Symbol="Stop"/>
                </Button>
                <!--Color-->
                <Button Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}" Foreground="{ThemeResource AppBlueLinearGradientBrush}" Style="{StaticResource TextBlockButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Style="{StaticResource AppToolTipStyle}">
                            Color
                        </ToolTip>
                    </ToolTipService.ToolTip>
                    <Button.Flyout>
                        <Flyout Placement="Left">
                            <elements:ColorPicker2 x:Name="ColorPicker" Color="DodgerBlue"/>
                        </Flyout>
                    </Button.Flyout>
                    <Ellipse Width="24" Height="24" StrokeThickness="1" Stroke="Gray">
                        <Ellipse.Fill>
                            <SolidColorBrush Color="{x:Bind ColorPicker.Color, Mode=OneWay}"/>
                        </Ellipse.Fill>
                    </Ellipse>
                </Button>
            </StackPanel>
        </ScrollViewer>

        <!--Play-->
        <Grid x:Name="PlayGrid" Grid.Row="1" BorderThickness="0,1" HorizontalAlignment="Center"
                Width="{StaticResource AppBarHeight}" Height="{StaticResource AppBarHeight}"
                Visibility="{x:Bind IntToVisibilityConverter(GroupIndex), Mode=OneWay}">
            <elements:PlayRing x:Name="PlayRing"/>
            <Button x:Name="PlayButton" Foreground="{ThemeResource AppBlueLinearGradientBrush}" HorizontalAlignment="Center" Style="{StaticResource TextBlockButtonStyle}"
                        Visibility="{x:Bind ReverseBooleanToVisibilityConverter(ViewModel.IsPlaying), Mode=OneWay}">
                <ToolTipService.ToolTip>
                    <ToolTip Style="{StaticResource AppToolTipStyle}">
                        Play
                    </ToolTip>
                </ToolTipService.ToolTip>
                <SymbolIcon Symbol="Play"/>
            </Button>
            <Button x:Name="PauseButton" Foreground="{ThemeResource AppBlueLinearGradientBrush}" HorizontalAlignment="Center" Style="{StaticResource TextBlockButtonStyle}"
                        Visibility="{x:Bind BooleanToVisibilityConverter(ViewModel.IsPlaying), Mode=OneWay}">
                <ToolTipService.ToolTip>
                    <ToolTip Style="{StaticResource AppToolTipStyle}">
                        Pause
                    </ToolTip>
                </ToolTipService.ToolTip>
                <SymbolIcon Symbol="Pause"/>
            </Button>
        </Grid>

        <!--Loading-->
        <ContentDialog x:Name="LoadingDialog" Grid.RowSpan="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ProgressRing Width="28" Height="28" IsActive="{x:Bind IsLoading, Mode=OneWay}"/>
                <TextBlock Grid.Row="1" HorizontalAlignment="Center">
                    Loading
                </TextBlock>
            </Grid>
        </ContentDialog>

    </Grid>
</Page>